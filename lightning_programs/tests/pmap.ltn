var assert_counter = require("assert_counter.ltn")
var assert = assert_counter.assert
var assert_not = assert_counter.assert_not
{
    // Testing pmap
    var n = 100
    var table1 = List(n)

    function init(index, collection)
    {
        collection[index] = []
        collection[index].x = 1
    }
    table1:list_pmap(init)
    for (var i = 0; i<n; i++)
    {
        assert(table1[i].x, 1, "Failed pmap Test 1, iteration:" .. i .. ".")
    }

    table1 = List(n)
    function init_number(index, collection)
    {
        collection[index] = 1
    }
    table1:list_pmap(init_number)
    for (var i = 0; i<n; i++)
    {
        assert(table1[i], 1, "Failed pmap Test 2, iteration: " .. i .. ".")
    }

    table1 = List(n)
    table1:list_pmap(function(index, collection)
    {
        collection[index] = 100 - index
    })
    for (var i = 0; i<n; i++)
    {
        assert(table1[i], n - i, "Failed pmap Test 3, iteration: " .. i .. ".")
    }
}
return assert_counter.get_error_counter()